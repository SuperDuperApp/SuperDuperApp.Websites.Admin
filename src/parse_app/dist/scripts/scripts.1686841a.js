"use strict";angular.module("adminApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/brand",{templateUrl:"views/brand.html",controller:"BrandCtrl"}).when("/brand/:id/photo",{templateUrl:"views/brandphoto.html",controller:"BrandPhotoCtrl"}).when("/brand_type",{templateUrl:"views/brandtype.html",controller:"BrandTypeCtrl"}).when("/product_type",{templateUrl:"views/producttype.html",controller:"ProductTypeCtrl"}).when("/product_season",{templateUrl:"views/productseason.html",controller:"ProductSeasonCtrl"}).when("/product",{templateUrl:"views/product.html",controller:"ProductCtrl"}).when("/product/:id/match",{templateUrl:"views/match.html",controller:"MatchCtrl"}).when("/product/:id/photo",{templateUrl:"views/photo.html",controller:"ProductPhotoCtrl"}).when("/product/:productId/match/:id/photo",{templateUrl:"views/matchphoto.html",controller:"MatchPhotoCtrl"}).when("/settings",{templateUrl:"views/settings.html",controller:"SettingsCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope",function(a){Parse.initialize("3sC6jbS7mjqMHE9x2aanasCy6Bd47RnwvA3mQfWo","J4ztKxZVA5O7Nx1AmhiT6lZ0uaKywEeXAU1jWRpi"),a.logout=function(){Parse.User.logOut(),location.reload()};var b=Parse.User.current();b?a.$apply(function(){a.loggedIn=!0}):($(".login-modal").modal("show"),a.$apply(function(){a.loggedIn=!1}))}]),angular.module("adminApp").service("BrandService",function(){this.items=[],this.list=function(a){console.log("BrandService::List");var b=this,c=Parse.Object.extend("Brand"),d=new Parse.Query(c);d.ascending("name"),d.find({success:function(c){console.log("BrandService::List::Success - "+c.length),b.items=c,a&&a()},error:function(b){alert("Error: "+b.code+" "+b.message),a&&a()}})},this.save=function(a,b){var c=Parse.Object.extend("Brand"),d=new c,e=this;d.save(a,{success:function(a){e.items.push(a),b&&b()},error:function(a,b){console.log("create Brand Object failed"),console.log(b)}})},this.update=function(a,b){a.save(null,{success:function(){b&&b()},error:function(a,b){console.log("update Brand Object failed"),console.log(b)}})},this.destroy=function(a,b){var c=this;a.destroy({success:function(){var d=c.items.map(function(a){return a.id}).indexOf(a.id);c.items.splice(d,1),b&&b()},error:function(a,b){console.log("destroying Brand Object failed"),console.log(b)}})},this.matchCount=function(a,b){var c=Parse.Object.extend("Product"),d=new Parse.Query(c);d.greaterThanOrEqualTo("matchCount",1),d.equalTo("brand",a),d.find({success:function(a){b&&b(a)},error:function(a){alert("Error: "+a.code+" "+a.message),b&&b()}})}}),angular.module("adminApp").service("ProductService",function(){this.items=[],this.list=function(a){console.log("ProductService::List");var b=this,c=Parse.Object.extend("Product"),d=new Parse.Query(c);d.limit(1e3),d.ascending("color"),d.find({success:function(c){console.log("ProductService::List::Success - "+c.length),b.items=c,a&&a()},error:function(b){alert("Error: "+b.code+" "+b.message),a&&a()}})},this.item=function(a,b){for(var c=this,d=null,e=0;e<c.items.length;e++);if(null===d){var f=Parse.Object.extend("Product"),g=new Parse.Query(f);g.get(a,{success:function(a){b&&b(a)},error:function(a){alert("Error: "+a.code+" "+a.message)}})}}}),angular.module("adminApp").service("MatchService",function(){}),angular.module("adminApp").service("BrandPhotoService",function(){}),angular.module("adminApp").service("MatchPhotoService",function(){}),angular.module("adminApp").service("ProductPhotoService",function(){}),angular.module("adminApp").service("ProductSeasonService",function(){this.items=[],this.list=function(a){console.log("ProductSeasonService::List");var b=this,c=Parse.Object.extend("ProductSeason"),d=new Parse.Query(c);d.find({success:function(c){console.log("ProductSeasonService::List::Success - "+c.length),b.items=c,a&&a()},error:function(a){alert("Error: "+a.code+" "+a.message)}})}}),angular.module("adminApp").service("ProductTypeService",function(){this.items=[],this.list=function(a){var b=this,c=Parse.Object.extend("ProductType"),d=new Parse.Query(c);d.find({success:function(c){b.items=c,a&&a()},error:function(a){alert("Error: "+a.code+" "+a.message)}})}}),angular.module("adminApp").controller("MainCtrl",["$scope","$rootScope","$timeout","BrandService",function(a,b,c,d){b.activeView="home",a.rows=[],a.totalMatchedCount=0,a.totalMatches=0,a.findMatched=function(b){var e=d.items[b];e.get("visible")?d.matchCount(e,function(f){for(var g=f.length,h=0;g--;){var i=f[g],j=Number(i.get("matchCount"));h+=j}var k={name:e.get("name"),matchedCount:f.length,total:h};a.rows.push(k),a.totalMatchedCount+=f.length,a.totalMatches+=h,b<d.items.length-1?(b++,a.findMatched(b)):c(function(){a.$digest()})}):b<d.items.length-1?(b++,a.findMatched(b)):c(function(){a.$digest()})},d.list(function(){a.findMatched(0)})}]),angular.module("adminApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("adminApp").controller("BrandCtrl",["$scope","$rootScope","$location","$timeout","BrandService",function(a,b,c,d,e){b.activeView="brand",a.title="Brands",a.loading=!0,a.rows=[],a.showPhotos=function(a){c.path("brand/"+a.model.id+"/photo")},a.itemButtons=[],a.createRow=function(b){var c="",d="",e=null,f="",g="";return b.get("parent")&&(e=a.findModelById(b.get("parent").id,a.brands),c=e.id,d=e.get("name")),b.get("photo1")&&(f=b.get("photo1").url()),b.get("photo2")&&(g=b.get("photo2").url()),{id:b.id,model:b,name:b.get("name"),visible:b.get("visible"),parent:d,parentId:c,photo1:f,photo1_name:b.get("photo1_name"),photo1_desc:b.get("photo1_desc"),photo2:g,photo2_name:b.get("photo2_name"),photo2_desc:b.get("photo2_desc"),keywords:b.get("keywords"),show:!0}},a.searchColumns=["name"],a.createColumns=function(){a.columns=[{label:"Name",key:"name",value:"",inputType:"text",hidden:!1},{label:"Parent",key:"parent",value:"",inputType:"rel",collection:a.brands,hidden:!0},{label:"Visible",key:"visible",value:!0,inputType:"checkbox",hidden:!1},{label:"Photo 1",key:"photo1",value:"",inputType:"image",hidden:!0},{label:"Photo 1 Name",key:"photo1_name",value:"",inputType:"text",hidden:!0},{label:"Short Description",key:"photo1_desc",value:"",inputType:"textarea",hidden:!0},{label:"Photo 2",key:"photo2",value:"",inputType:"image",hidden:!0},{label:"Photo 2 Name",key:"photo2_name",value:"",inputType:"text",hidden:!0},{label:"Longer Description",key:"photo2_desc",value:"",inputType:"textarea",hidden:!0},{label:"Keywords",key:"keywords",value:"",inputType:"text",hidden:!0}]},a.listSort=function(a,b){return a.get("name")<b.get("name")?-1:a.get("name")>b.get("name")?1:0},a.findModelById=function(a,b){for(var c=b.length,d=null;c--;){var e=b[c];if(e.id===a){d=e.model;break}}return d},a.createModelObject=function(){var b,c,d={},e=[];for(b=0;b<a.columns.length;b++){var f=a.columns[b];if("rel"===f.inputType)d[f.key]=a.findModelById(f.value,f.collection);else if("image"===f.inputType){if("string"!=typeof f.value){var g=f.key+".jpg";for(c=0;c<a.columns.length;c++)if(a.columns[c].key===f.key+"_name"){""!==a.columns[c].value&&(g=a.columns[c].value+".jpg");break}e.push({key:f.key,file:new Parse.File(g,f.value)})}}else"none"===f.inputType||"swatch"===f.inputType||(d[f.key]=f.value)}e[0].file?e[0].file.save().then(function(){d[e[0].key]=e[0].file,e[1]&&e[1].file?e[1].file.save().then(function(){d[e[1].key]=e[1].file,a.saveModelObject(d,!1)}):a.saveModelObject(d,!1)}):a.saveModelObject(d,!1)},a.saveModelObject=function(b,c){c?e.update(b,function(){e.items.sort(a.listSort),a.listModelObjects()}):e.save(b,function(){e.items.sort(a.listSort),a.listModelObjects()})},a.updateModelObject=function(b){var c,d,e=b.model,f=[];for(a.loading=!0,c=0;c<a.columns.length;c++){var g=a.columns[c];if("rel"===g.inputType)e.set(g.key,a.findModelById(b[g.key],g.collection));else if("image"===g.inputType){if("string"!=typeof b[g.key]){var h=g.key+".jpg";for(d=0;d<a.columns.length;d++)if(a.columns[d].key===g.key+"_name"){""!==b[a.columns[d].key]&&(h=b[a.columns[d].key]+".jpg");break}f.push({key:g.key,file:new Parse.File(h,b[g.key])})}}else"none"===g.inputType||"swatch"===g.inputType||e.set(g.key,b[g.key])}f.length>0&&f[0].file?f[0].file.save().then(function(){e.set(f[0].key,f[0].file),f[1]&&f[1].file?f[1].file.save().then(function(){e.set(f[1].key,f[1].file),a.saveModelObject(e,!0)}):a.saveModelObject(e,!0)}):a.saveModelObject(e,!0)},a.deleteModelObject=function(b){a.loading=!0;var c=b.model;e.destroy(c,function(){a.listModelObjects()})},a.listModelObjects=function(){0===e.items.length?e.list(function(){a.createRowsFromList(e.items,!0)}):a.createRowsFromList(e.items,!1)},a.createRowsFromList=function(b){a.brands=[];for(var c=0;c<b.length;c++){var e=b[c];e.get("parent")||a.brands.push({id:e.id,name:e.get("name"),model:e})}a.rows=[];for(var f=[],c=0;c<b.length;c++){var e=b[c];f.push(a.createRow(e))}d(function(){a.rows=f,a.createColumns(),a.loading=!1,a.$apply()})},a.listModelObjects()}]),angular.module("adminApp").controller("ProductTypeCtrl",["$scope","$rootScope",function(a,b){b.activeView="product_type",a.title="Product Types",a.loading=!0,a.rows=[],a.createRow=function(a,b,c){return{id:c.id,name:a,visible:b,model:c,show:!0}},a.searchColumns=["name"],a.createColumns=function(){a.columns=[{label:"Name",key:"name",value:"",inputType:"text",hidden:!1},{label:"Visible",key:"visible",value:!0,inputType:"checkbox",hidden:!1}]},a.createModelObject=function(){a.loading=!0;for(var b=Parse.Object.extend("ProductType"),c=new b,d={},e=0;e<a.columns.length;e++){var f=a.columns[e];d[f.key]=f.value}c.save(d,{success:function(){a.listModelObjects()},error:function(a,b){console.log("create ProductType Object failed"),console.log(b)}})},a.updateModelObject=function(b){a.loading=!0;for(var c=b.model,d=0;d<a.columns.length;d++){var e=a.columns[d];c.set(e.key,b[e.key])}c.save(null,{success:function(){a.listModelObjects()},error:function(a,b){console.log("update ProductType Object failed"),console.log(b)}})},a.deleteModelObject=function(b){a.loading=!0;var c=b.model;c.destroy({success:function(){a.listModelObjects()},error:function(a,b){console.log("destroying ProductType Object failed"),console.log(b)}})},a.listModelObjects=function(){a.loading=!0;var b=Parse.Object.extend("ProductType"),c=new Parse.Query(b);c.ascending("name"),c.find({success:function(b){a.rows=[];for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.createRow(e.get("name"),e.get("visible"),e))}a.$apply(function(){a.rows=c,a.createColumns(),a.loading=!1})},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.listModelObjects()}]),angular.module("adminApp").controller("ProductSeasonCtrl",["$scope","$rootScope",function(a,b){b.activeView="product_season",a.title="Product Seasons",a.loading=!0,a.createRow=function(a,b,c){return{id:c.id,name:a,visible:b,model:c,show:!0}},a.searchColumns=["name"],a.createColumns=function(){a.columns=[{label:"Name",key:"name",value:"",inputType:"text",hidden:!1},{label:"Visible",key:"visible",value:!0,inputType:"checkbox",hidden:!1}]},a.rows=[],a.createModelObject=function(){a.loading=!0;for(var b=Parse.Object.extend("ProductSeason"),c=new b,d={},e=0;e<a.columns.length;e++){var f=a.columns[e];d[f.key]=f.value}c.save(d,{success:function(){a.listModelObjects()},error:function(a,b){console.log("create ProductSeason Object failed"),console.log(b)}})},a.updateModelObject=function(b){a.loading=!0;for(var c=b.model,d=0;d<a.columns.length;d++){var e=a.columns[d];c.set(e.key,b[e.key])}c.save(null,{success:function(){a.listModelObjects()},error:function(a,b){console.log("update ProductSeason Object failed"),console.log(b)}})},a.deleteModelObject=function(b){a.loading=!0;var c=b.model;c.destroy({success:function(){a.listModelObjects()},error:function(a,b){console.log("destroying ProductSeason Object failed"),console.log(b)}})},a.listModelObjects=function(){var b=Parse.Object.extend("ProductSeason"),c=new Parse.Query(b);c.ascending("name"),c.find({success:function(b){a.rows=[];for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.createRow(e.get("name"),e.get("visible"),e))}a.$apply(function(){a.rows=c,a.createColumns(),a.loading=!1})},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.listModelObjects()}]),angular.module("adminApp").controller("ProductCtrl",["$scope","$rootScope","$location","$timeout","ProductService","BrandService","ProductSeasonService","ProductTypeService",function(a,b,c,d,e,f,g,h){b.activeView="product",a.title="Products",a.rows=[],a.columns=[],a.loading=!0,a.showMatches=function(a){c.path("product/"+a.model.id+"/match")},a.showPhotos=function(a){c.path("product/"+a.model.id+"/photo")},a.itemButtons=[{label:"Matches",action:a.showMatches,cls:"btn-info"},{label:"Photos",action:a.showPhotos,cls:"btn-primary"}],a.searchColumns=["color","colorNumber","brand"],a.createColumns=function(){a.columns=[{label:"",key:"hex",value:"",inputType:"swatch",hidden:!1},{label:"Color",key:"color",value:"",inputType:"text",hidden:!1},{label:"Color #",key:"colorNumber",value:"",inputType:"text",hidden:!1},{label:"Brand",key:"brand",value:"",inputType:"rel",collection:a.brands,hidden:!1},{label:"Price",key:"price",value:0,inputType:"number",hidden:!0},{label:"In Stock",key:"inStock",value:!1,inputType:"checkbox",hidden:!1},{label:"Visible",key:"visible",value:!0,inputType:"checkbox",hidden:!1},{label:"M",key:"matchCount",value:"",inputType:"none",hidden:!1},{label:"P",key:"photoCount",value:"",inputType:"none",hidden:!1},{label:"Shopping Link",key:"shoppingLink",value:"",inputType:"text",hidden:!0},{label:"Visible",key:"shoppingLinkVisible",value:!1,inputType:"checkbox",hidden:!0},{label:"Hex",key:"hex",value:"",inputType:"text",hidden:!0},{label:"Season",key:"productSeason",value:"",inputType:"rel",collection:a.productSeasons,hidden:!0},{label:"Type",key:"productType",value:a.productTypes[0].id||"",inputType:"rel",collection:a.productTypes,hidden:!0},{label:"Copy",key:"displayCopy",value:"",inputType:"textarea",hidden:!0},{label:"Notes",key:"notes",value:"",inputType:"textarea",hidden:!0}],a.loading=!1},a.createRow=function(b){var c="",d="",e="",f=null,g=null,h=null,i=null,j=null,k=null;return b.get("brand")&&(i=a.findModelById(b.get("brand").id,a.brands)),b.get("productSeason")&&(j=a.findModelById(b.get("productSeason").id,a.productSeasons)),b.get("productType")&&(k=a.findModelById(b.get("productType").id,a.productTypes)),i&&(c=i.get("name"),f=i.id),j&&(d=j.get("name"),g=j.id),k&&(e=k.get("name"),h=k.id),{id:b.id,photoCount:b.get("photoCount"),matchCount:b.get("matchCount"),hex:b.get("hex"),notes:b.get("notes"),color:b.get("color"),colorNumber:b.get("colorNumber"),displayCopy:b.get("displayCopy"),inStock:b.get("inStock"),price:b.get("price"),brand:c,productSeason:d,productType:e,brandId:f,productSeasonId:g,productTypeId:h,visible:b.get("visible"),shoppingLink:b.get("shoppingLink"),shoppingLinkVisible:b.get("shoppingLinkVisible"),show:!0,model:b}},a.findModelById=function(a,b){for(var c=b.length,d=null;c--;){var e=b[c];if(e.id===a){d=e.model;break}}return d},a.createModelObject=function(){a.loading=!0;for(var b=Parse.Object.extend("Product"),c=new b,d={},f=0;f<a.columns.length;f++){var g=a.columns[f];"rel"===g.inputType?d[g.key]=a.findModelById(g.value,g.collection):"none"===g.inputType||"swatch"===g.inputType||(d[g.key]=g.value)}c.save(d,{success:function(){var b=a.createRow(c);a.rows.unshift(b),e.items.push(c),a.updateTitle(e.items.length),a.$apply()},error:function(a,b){console.log("create Product Object failed"),console.log(b)}})},a.updateModelObject=function(b){a.loading=!0;for(var c=b.model,d=0;d<a.columns.length;d++){var f=a.columns[d];"rel"===f.inputType?c.set(f.key,a.findModelById(b[f.key],f.collection)):"none"===f.inputType||"swatch"===f.inputType||c.set(f.key,b[f.key])}c.save(null,{success:function(){var b=0;for(b=0;b<a.rows.length&&c.id!==a.rows[b].id;b++);b<a.rows.length&&(a.rows[b]=a.createRow(c),e.items[b]=c,a.$apply())},error:function(a,b){console.log("update Product Object failed"),console.log(b)}})},a.deleteModelObject=function(b){a.loading=!0;var c=b.model,d=c.id;c.destroy({success:function(){var b=0;for(b=0;b<a.rows.length&&d!==a.rows[b].id;b++);b<a.rows.length&&(a.rows.splice(b,1),e.items.splice(b,1),a.updateTitle(e.items.length),a.$apply())},error:function(a,b){console.log("destroying Product Object failed"),console.log(b)}})},a.createProductTypeListItem=function(a,b){return{id:b.id,name:a,model:b}},a.listProductTypeModelObjects=function(){0===h.items.length?h.list(function(){a.createProductTypeObjects(h.items)}):a.createProductTypeObjects(h.items)},a.createProductTypeObjects=function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.createProductTypeListItem(e.get("name"),e))}a.productTypes=c,a.listModelObjects()},a.createProductSeasonListItem=function(a,b){return{id:b.id,name:a,model:b}},a.listProductSeasonModelObjects=function(){0===g.items.length?g.list(function(){a.createProductSeasonObjects(g.items)}):a.createProductSeasonObjects(g.items)},a.createProductSeasonObjects=function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.createProductSeasonListItem(e.get("name"),e))}a.productSeasons=c,a.listProductTypeModelObjects()},a.createBrandListItem=function(a,b){return{id:b.id,name:a,model:b}},a.listBrandModelObjects=function(){a.loading=!0,0===f.items.length?f.list(function(){a.createBrandObjects(f.items)}):a.createBrandObjects(f.items)},a.createBrandObjects=function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.createBrandListItem(e.get("name"),e))}a.brands=c,a.listProductSeasonModelObjects()},a.listModelObjects=function(){0===e.items.length?e.list(function(){a.createRowsFromList(e.items)}):a.createRowsFromList(e.items)},a.updateTitle=function(b){a.title="Products ("+b+")"},a.createRowsFromList=function(b){a.rows=[],a.updateTitle(b.length),a.createColumns(),console.log("finished"),a.createPartialRows(b,0,50)},a.createPartialRows=function(b,c,e){for(var f=[],g=0;e>g&&!(g+c>=b.length);g++){var h=b[c+g];f.push(a.createRow(h))}a.rows=a.rows.concat(f),g>=e&&d(function(){a.createPartialRows(b,c+e,e)},10)},a.rows=[],a.listBrandModelObjects()}]),angular.module("adminApp").directive("listView",["$timeout",function(a){return{templateUrl:"views/partials/list-view.html",restrict:"E",scope:{title:"=",columns:"=",rows:"=",createModelObject:"=",updateModelObject:"=",deleteModelObject:"=",itemButtons:"=",loading:"=",resetColumns:"=",searchColumns:"=",choiceSearchColumns:"=",showChoiceFirst:"="},link:function(b,c){b.editItem={},b.choiceRows=[],b.choiceColumns=[],b.showChoice=b.showChoiceFirst,b.searchStr="",b.choiceSearchStr="",b.activeChoice={},b.colSortOrders={},b.choiceColSortOrders={},b.sort=function(a){var b=1;return"-"===a[0]&&(b=-1,a=a.substr(1)),function(c,d){var e=c[a]<d[a]?-1:c[a]>d[a]?1:0;return e*b}},b.choiceColumnHeaderClick=function(a){for(var c=b.choiceColumns.length;c--;)a.key!==b.choiceColumns[c].key&&(a.sortOrder="");b.choiceColSortOrders[a.key]=b.choiceColSortOrders[a.key]||"","-"===b.choiceColSortOrders[a.key]?b.choiceColSortOrders[a.key]="":b.choiceColSortOrders[a.key]="-",b.choiceRows.sort(b.sort(b.choiceColSortOrders[a.key]+a.key))},b.columnHeaderClick=function(a){for(var c=b.columns.length;c--;)a.key!==b.columns[c].key&&(a.sortOrder="");b.colSortOrders[a.key]=b.colSortOrders[a.key]||"","-"===b.colSortOrders[a.key]?b.colSortOrders[a.key]="":b.colSortOrders[a.key]="-",b.rows.sort(b.sort(b.colSortOrders[a.key]+a.key))},b.choiceSearchInputChange=function(){for(var a=b.choiceSearchStr.toLowerCase(),c=b.choiceRows.length;c--;){var d=b.choiceRows[c];if(""===a.trim())d.show=!0;else{d.show=!1;for(var e=b.choiceSearchColumns.length;e--;){var f=b.choiceSearchColumns[e],g=d[f];if(g.toLowerCase().indexOf(a)>=0){d.show=!0;break}}}}},b.searchInputChange=function(){for(var a=b.searchStr.toLowerCase(),c=b.rows.length;c--;){var d=b.rows[c];if(""===a.trim())d.show=!0;else{d.show=!1;for(var e=b.searchColumns.length;e--;){var f=b.searchColumns[e],g=d[f];if(g.toLowerCase().indexOf(a)>=0){d.show=!0;break}}}}},b.addCloseButtonClick=function(){},b.chooseButtonClick=function(a,c){b.activeChoice=a,b.choiceColumns=c.columns,b.choiceRows=c.rows,b.showChoice=!0},b.selectButtonClick=function(a){for(var c=b.choiceRows.length;c--;)b.choiceRows[c].selected=!1;b.activeChoice.model=a.model,b.activeChoice.value="";for(var d=0;d<b.choiceColumns.length;d++){var e=b.choiceColumns[d];e.useAsSelectedLabel&&(b.activeChoice.value+=a[e.key]+" ")}a.selected=!0;for(var f=0;f<b.columns.length;f++){var g=b.columns[f];if("choice"===g.inputType){b.editItem[g.key]=b.activeChoice.value,b.editItem.choice=g.model;break}}b.showChoice=!1},b.editCloseButtonClick=function(){b.editItem={}},b.saveButtonClick=function(){b.createModelObject(),$(c).find(".add-modal").modal("hide")},b.updateButtonClick=function(){b.updateModelObject(b.editItem),$(c).find(".edit-modal").modal("hide")},b.deleteButtonClick=function(){b.deleteModelObject(b.editItem),$(c).find(".edit-modal").modal("hide")},b.viewButtonClick=function(d){a(function(){b.$apply(function(){b.viewItem=d})}),$(c).find(".read-modal").modal("show")},b.addButtonClick=function(){if(b.editMode=!1,b.showChoiceFirst)for(var a=0;a<b.columns.length;a++){var d=b.columns[a];if("choice"===d.inputType){console.log(d),b.chooseButtonClick(d,d.collection);break}}$(c).find(".add-modal input").val(""),$(c).find(".add-modal").modal()},b.editButtonClick=function(a){b.editItem={},b.editMode=!0,b.showChoice=!1;for(var d in a)b.editItem[d]=a[d];for(var e=0;e<b.columns.length;e++){var f=b.columns[e];"rel"===f.inputType?b.editItem[f.key]=a[f.key+"Id"]:"choice"===f.inputType?b.editItem[f.key]=a[f.key]:b.editItem[f.key]=a[f.key]}$(c).find(".edit-modal").modal("show")}}}}]),angular.module("adminApp").controller("MatchCtrl",["$scope","$rootScope","$route","$timeout","$location","ProductService","BrandService","ProductSeasonService","ProductTypeService",function(a,b,c,d,e,f,g,h,i){b.activeView="product",a.title="Product - Matches",a.rows=[],a.columns=[],a.loading=!0,a.productId=c.current.params.id,a.productName="",a.products=[],a.brands=[],a.productChoiceDataSource={columns:[],rows:[]},a.showChoiceFirst=!0,a.choiceSearchColumns=["color","brand"],a.showPhotos=function(b){e.path("product/"+a.productId+"/match/"+b.model.id+"/photo")},a.itemButtons=[{label:"Photos",action:a.showPhotos,cls:"btn-primary"}],a.searchColumns=["match"],a.createColumns=function(){a.columns=[{label:"Copy",key:"displayCopy",value:"",inputType:"textarea",hidden:!0},{label:"Notes",key:"notes",value:"",inputType:"textarea",hidden:!0},{label:"References",key:"references",value:"",inputType:"textarea",hidden:!0},{label:"Match",key:"match",value:"None chosen.",inputType:"choice",collection:a.productChoiceDataSource,model:null,hidden:!1},{label:"Brand",key:"brand",value:"",inputType:"none",hidden:!1},{label:"Order Index",key:"orderIndex",value:0,inputType:"number",hidden:!1},{label:"Visible",key:"visible",value:!0,inputType:"checkbox",hidden:!1},{label:"P",key:"photoCount",value:"",inputType:"none",hidden:!1}],a.loading=!1},a.createRow=function(b){var c=a.products.length,d="",e="";if(b.get("match"))for(var f=b.get("match").id;c--;){var g=a.products[c];if(g.id===f){d=g.get("color");var h=g.get("brand");if(h)for(var i=a.brands.length;i--;){var j=a.brands[i];if(j.id===h.id){e=j.name;break}}break}}return{id:b.id,displayCopy:b.get("displayCopy"),notes:b.get("notes"),references:b.get("references"),match:d,brand:e,visible:b.get("visible"),photoCount:b.get("photoCount"),model:b,orderIndex:b.get("orderIndex"),show:!0}},a.findModelById=function(a,b){for(var c=b.length,d=null;c--;){var e=b[c];if(e.id===a){d=e.model;break}}return d},a.createModelObject=function(){a.loading=!0;for(var b=Parse.Object.extend("Match"),c=new b,d={},e=0;e<a.columns.length;e++){var f=a.columns[e];"rel"===f.inputType?d[f.key]=a.findModelById(f.value,f.collection):"choice"===f.inputType?d[f.key]=f.model:"none"===f.inputType||"swatch"===f.inputType||(d[f.key]=f.value)}c.save(d,{success:function(){var b=a.product.relation("matches");b.add(c),a.product.save({success:function(){a.listModelObjects()},error:function(a,b){console.log("create Product Object failed"),console.log(b)}})},error:function(a,b){console.log("create Product Object failed"),console.log(b)}})},a.updateModelObject=function(b){a.loading=!0;for(var c=b.model,d=0;d<a.columns.length;d++){var e=a.columns[d];"rel"===e.inputType?c.set(e.key,a.findModelById(b[e.key],e.collection)):"choice"===e.inputType?c.set(e.key,b.choice):"none"===e.inputType||"swatch"===e.inputType||c.set(e.key,b[e.key])}c.save(null,{success:function(){a.listModelObjects()},error:function(a,b){console.log("update Product Object failed"),console.log(b)}})},a.deleteModelObject=function(b){a.loading=!0;var c=a.product.relation("matches");c.remove(b.model),a.product.save({success:function(){a.listModelObjects()},error:function(a,b){console.log("remove Product Match Object failed"),console.log(b)}})},a.createProductTypeListItem=function(a,b){return{id:b.id,name:a,model:b}},a.createProductTypeObjects=function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.createProductTypeListItem(e.get("name"),e))}a.productTypes=c,a.listProductModelObjects()},a.listProductTypeModelObjects=function(){0===i.items.length?i.list(function(){a.createProductTypeObjects(i.items)}):a.createProductTypeObjects(i.items)},a.createProductSeasonListItem=function(a,b){return{id:b.id,name:a,model:b}},a.createProductSeasonObjects=function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.createProductSeasonListItem(e.get("name"),e))}a.productSeasons=c,a.listProductTypeModelObjects()},a.listProductSeasonModelObjects=function(){0===h.items.length?h.list(function(){a.createProductSeasonObjects(h.items)}):a.createProductSeasonObjects(h.items)},a.createBrandListItem=function(a,b){return{id:b.id,name:a,model:b}},a.createBrandObjects=function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.createBrandListItem(e.get("name"),e))}a.brands=c,a.listProductSeasonModelObjects()},a.listBrandModelObjects=function(){0===g.items.length?g.list(function(){a.createBrandObjects(g.items)}):a.createBrandObjects(g.items)},a.createProductsFromList=function(b){a.products=b;for(var c=[{label:"Color",key:"color",value:"",inputType:"text",useAsSelectedLabel:!0},{label:"Brand",key:"brand",value:"",inputType:"text",useAsSelectedLabel:!0}],d=[],e=0;e<a.products.length;e++){var f=a.products[e],g="",h=f.get("brand");if(h)for(var i=a.brands.length;i--;){var j=a.brands[i];if(j.id===h.id){g=j.name;break}}d.push({color:f.get("color"),brand:g,model:f,selected:!1,show:!0})}a.productChoiceDataSource.columns=c,a.productChoiceDataSource.rows=d,a.listModelObjects()},a.listProductModelObjects=function(){0===f.items.length?f.list(function(){a.createProductsFromList(f.items)}):a.createProductsFromList(f.items)},a.listModelObjects=function(){var b=a.product.relation("matches"),c=b.query();c.ascending("orderIndex"),c.limit(1e3),c.find({success:function(b){a.rows=[];for(var c=[],e=0;e<b.length;e++){var f=b[e];c.push(a.createRow(f))}d(function(){a.$apply(function(){a.rows=c,a.createColumns()})}),a.product.set("matchCount",c.length),a.product.save({success:function(){},error:function(a,b){console.log("setting match count failed"),console.log(b)}})},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.getProductModelObject=function(){var b=Parse.Object.extend("Product"),c=new Parse.Query(b);c.get(a.productId,{success:function(b){a.product=b,a.productName=b.get("color"),a.title=a.productName+" - Matches",a.listBrandModelObjects()},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.getProductModelObject()}]),angular.module("adminApp").directive("matchListView",function(){return{templateUrl:"views/partials/match-list-view.html",restrict:"E",scope:{title:"=",parentRefresh:"=",show:"=",product:"=",brands:"=",productSeasons:"=",productTypes:"=",existingMatches:"="},link:function(a,b){a.editItem={},a.rows=[],a.columns=[],a.closeButtonClick=function(){a.show=!1},a.selectButtonClick=function(a){a.selected=!a.selected},a.saveButtonClick=function(){for(var c=a.product.relation("matches"),d=0;d<a.rows.length;d++){var e=a.rows[d];e.selected&&c.add(e.model)}a.product.save({success:function(){a.parentRefresh(),a.show=!1,$(b).find(".add-modal").modal("hide")},error:function(a,b){console.log("create Product Object failed"),console.log(b)}})},a.$watch("show",function(){a.show&&($(b).find(".add-modal").modal("show"),a.listProductModelObjects())}),a.createColumns=function(){a.columns=[{label:"Color",key:"color",value:"",inputType:"text"},{label:"Color #",key:"colorNumber",value:"",inputType:"text"},{label:"Price",key:"price",value:"",inputType:"number"},{label:"Brand",key:"brand",value:"",inputType:"rel",collection:a.brands},{label:"Season",key:"productSeason",value:"",inputType:"rel",collection:a.productSeasons},{label:"Type",key:"productType",value:"",inputType:"rel",collection:a.productTypes}]},a.findModelById=function(a,b){for(var c=b.length,d=null;c--;){var e=b[c];if(e.id===a){d=e.model;break}}return d},a.createRow=function(b){var c="",d="",e="",f=null,g=null,h=null,i=null,j=null,k=null;return b.get("brand")&&(i=a.findModelById(b.get("brand").id,a.brands)),b.get("productSeason")&&(j=a.findModelById(b.get("productSeason").id,a.productSeasons)),b.get("productType")&&(k=a.findModelById(b.get("productType").id,a.productTypes)),i&&(c=i.get("name"),f=i.id),j&&(d=j.get("name"),g=j.id),k&&(e=k.get("name"),h=k.id),{color:b.get("color"),colorNumber:b.get("colorNumber"),displayCopy:b.get("displayCopy"),inStock:b.get("inStock"),price:b.get("price"),references:b.get("references"),brand:c,productSeason:d,productType:e,brandId:f,productSeasonId:g,productTypeId:h,visible:b.get("visible"),model:b,selected:!1}},a.existingMatch=function(b){if(b.id===a.product.id)return!0;for(var c=a.existingMatches.length;c--;){var d=a.existingMatches[c].model;if(d.id===b.id)return!0}return!1},a.listProductModelObjects=function(){var b=Parse.Object.extend("Product"),c=new Parse.Query(b);c.find({success:function(b){a.rows=[];for(var c=[],d=0;d<b.length;d++){var e=b[d];a.existingMatch(e)||c.push(a.createRow(e))}a.$apply(function(){a.rows=c,a.createColumns()})},error:function(a){alert("Error: "+a.code+" "+a.message)}})}}}}),angular.module("adminApp").directive("photoListView",function(){return{template:"<div></div>",restrict:"E",link:function(a,b){b.text("this is the photoListView directive")}}}),angular.module("adminApp").controller("ProductPhotoCtrl",["$scope","$route",function(a,b){a.title="Product Photos",a.loading=!0,a.product={},a.productId=b.current.params.id,a.productName="",a.rows=[],a.createRow=function(a,b,c,d,e,f){return{id:f.id,name:a,image:b,displayCopy:c,orderIndex:d,visible:e,model:f,show:!0}},a.searchColumns=["name"],a.createColumns=function(){a.columns=[{label:"Name",key:"name",value:"",inputType:"text",hidden:!1},{label:"Image",key:"image",value:"",inputType:"image",hidden:!1},{label:"Display Copy",key:"displayCopy",value:"",inputType:"text",hidden:!1},{label:"Order Index",key:"orderIndex",value:0,inputType:"number",hidden:!1},{label:"Visible",key:"visible",value:!0,inputType:"checkbox",hidden:!1}],a.loading=!1},a.createModelObject=function(){a.loading=!0;for(var b=Parse.Object.extend("ProductPhoto"),c=new b,d={},e=null,f=0;f<a.columns.length;f++){var g=a.columns[f];if("image"===g.inputType){var h="photo.jpg";e=new Parse.File(h,g.value)}else d[g.key]=g.value}e.save().then(function(){c.set("image",e),c.save(d,{success:function(){var b=a.product.relation("photos");b.add(c),a.product.save({success:function(){a.listModelObjects()},error:function(a,b){console.log("create Product Object failed"),console.log(b)}})},error:function(a,b){console.log("create ProductPhoto Object failed"),console.log(b)}})},function(a){console.log("error saving photo image "+a)})},a.updateModelObject=function(b){a.loading=!0;for(var c=b.model,d=null,e=0;e<a.columns.length;e++){
var f=a.columns[e];if("image"===f.inputType){if("string"!=typeof b[f.key]){var g="photo.jpg";d=new Parse.File(g,b[f.key])}}else c.set(f.key,b[f.key])}var h=function(){c.save({success:function(){var b=a.product.relation("photos");b.add(c),a.product.save({success:function(){a.listModelObjects()},error:function(a,b){console.log("create Product Object failed"),console.log(b)}})},error:function(a,b){console.log("create ProductPhoto Object failed"),console.log(b)}})};d?d.save().then(function(){c.set("image",d),h()},function(a){console.log("error saving photo image "+a)}):h()},a.deleteModelObject=function(b){a.loading=!0;var c=b.model;c.destroy({success:function(){a.listModelObjects()},error:function(a,b){console.log("destroying ProductPhoto Object failed"),console.log(b)}})},a.listModelObjects=function(){var b=a.product.relation("photos"),c=b.query();c.ascending("orderIndex"),c.find({success:function(b){a.rows=[];for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.createRow(e.get("name"),e.get("image").url(),e.get("displayCopy"),e.get("orderIndex"),e.get("visible"),e))}a.$apply(function(){a.rows=c,a.createColumns()}),a.product.set("photoCount",c.length),a.product.save({success:function(){},error:function(a,b){console.log("setting product count failed"),console.log(b)}})},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.getProductModelObject=function(){var b=Parse.Object.extend("Product"),c=new Parse.Query(b);c.get(a.productId,{success:function(b){a.$apply(function(){a.product=b,a.productName=b.get("color"),a.title="Product Photos : "+a.productName,a.listModelObjects()})},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.getProductModelObject()}]),angular.module("adminApp").directive("fileRead",function(){return{scope:{fileRead:"="},link:function(a,b){b.bind("change",function(b){a.$apply(function(){a.fileRead=b.target.files[0]})})}}}),angular.module("adminApp").controller("MatchPhotoCtrl",["$scope","$route","$timeout",function(a,b,c){a.title="",a.loading=!0,a.product={},a.productId=b.current.params.productId,a.productName="",a.matchId=b.current.params.id,a.match={},a.matchName="",a.rows=[],a.createRow=function(a,b,c,d,e,f){return{id:f.id,name:a,image:b,displayCopy:c,orderIndex:d,visible:e,model:f,show:!0}},a.searchColumns=["name"],a.createColumns=function(){a.columns=[{label:"Name",key:"name",value:"",inputType:"text",hidden:!1},{label:"Image",key:"image",value:"",inputType:"image",hidden:!1},{label:"Display Copy",key:"displayCopy",value:"",inputType:"text",hidden:!1},{label:"Order Index",key:"orderIndex",value:0,inputType:"number",hidden:!1},{label:"Visible",key:"visible",value:!0,inputType:"checkbox",hidden:!1}],a.loading=!1},a.createModelObject=function(){a.loading=!0;for(var b=Parse.Object.extend("MatchPhoto"),c=new b,d={},e=null,f=0;f<a.columns.length;f++){var g=a.columns[f];if("image"===g.inputType){var h="photo.jpg";e=new Parse.File(h,g.value)}else d[g.key]=g.value}e.save().then(function(){c.set("image",e),c.save(d,{success:function(){var b=a.match.relation("photos");b.add(c),a.match.save({success:function(){a.listModelObjects()},error:function(a,b){console.log("create Product Object failed"),console.log(b)}})},error:function(a,b){console.log("create MatchPhoto Object failed"),console.log(b)}})},function(a){console.log("error saving photo image "+a)})},a.updateModelObject=function(b){a.loading=!0;for(var c=b.model,d=null,e=0;e<a.columns.length;e++){var f=a.columns[e];if("image"===f.inputType){if("string"!=typeof b[f.key]){var g="photo.jpg";d=new Parse.File(g,b[f.key])}}else c.set(f.key,b[f.key])}var h=function(){c.save({success:function(){var b=a.match.relation("photos");b.add(c),a.match.save({success:function(){a.listModelObjects()},error:function(a,b){console.log("create Product Object failed"),console.log(b)}})},error:function(a,b){console.log("create MatchPhoto Object failed"),console.log(b)}})};d?d.save().then(function(){c.set("image",d),h()},function(a){console.log("error saving photo image "+a)}):h()},a.deleteModelObject=function(b){a.loading=!0;var c=b.model;c.destroy({success:function(){a.listModelObjects()},error:function(a,b){console.log("destroying MatchPhoto Object failed"),console.log(b)}})},a.listModelObjects=function(){var b=a.match.relation("photos"),d=b.query();d.ascending("orderIndex"),d.find({success:function(b){a.rows=[];for(var d=[],e=0;e<b.length;e++){var f=b[e];d.push(a.createRow(f.get("name"),f.get("image").url(),f.get("displayCopy"),f.get("orderIndex"),f.get("visible"),f))}c(function(){a.$apply(function(){a.rows=d,a.createColumns()})}),a.match.set("photoCount",d.length),a.match.save({success:function(){},error:function(a,b){console.log("setting match photo count failed"),console.log(b)}})},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.getProductModelObject=function(){var b=Parse.Object.extend("Product"),c=new Parse.Query(b);c.get(a.productId,{success:function(b){a.product=b,a.productName=b.get("color"),a.title="Product Photos : "+a.productName+" : "+a.matchName,a.listModelObjects()},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.getMatchModelObject=function(){var b=Parse.Object.extend("Match"),c=new Parse.Query(b);c.get(a.matchId,{success:function(b){a.match=b,a.match.get("match").fetch({success:function(b){a.matchName=b.get("color"),a.getProductModelObject()},error:function(a){console.log(a)}})},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.getMatchModelObject()}]),angular.module("adminApp").controller("LoginCtrl",["$scope","$rootScope",function(a,b){a.uname="",a.password="",a.submitButtonClick=function(){Parse.User.logIn(a.uname,a.password,{success:function(a){b.$apply(function(){b.loggedIn=!0}),console.log(a),$(".login-modal").modal("hide")},error:function(a,c){b.loggedIn=!1,console.log(a),alert(c.code+" : "+c.message)}})}}]),angular.module("adminApp").controller("BrandPhotoCtrl",["$scope","$route",function(a,b){a.title="Brand Photos",a.loading=!0,a.brand={},a.brandId=b.current.params.id,a.brandName="",a.rows=[],a.createRow=function(a,b,c,d,e,f){return{id:f.id,name:a,image:b,displayCopy:c,orderIndex:d,visible:e,model:f,show:!0}},a.searchColumns=["name"],a.createColumns=function(){a.columns=[{label:"Name",key:"name",value:"",inputType:"text",hidden:!1},{label:"Image",key:"image",value:"",inputType:"image",hidden:!1},{label:"Display Copy",key:"displayCopy",value:"",inputType:"text",hidden:!1},{label:"Order Index",key:"orderIndex",value:0,inputType:"number",hidden:!1},{label:"Visible",key:"visible",value:!0,inputType:"checkbox",hidden:!1}],a.loading=!1},a.createModelObject=function(){a.loading=!0;for(var b=Parse.Object.extend("BrandPhoto"),c=new b,d={},e=null,f=0;f<a.columns.length;f++){var g=a.columns[f];if("image"===g.inputType){var h="photo.jpg";e=new Parse.File(h,g.value)}else d[g.key]=g.value}e.save().then(function(){c.set("image",e),c.save(d,{success:function(){var b=a.brand.relation("photos");b.add(c),a.brand.save({success:function(){a.listModelObjects()},error:function(a,b){console.log("create Brand Object failed"),console.log(b)}})},error:function(a,b){console.log("create BrandPhoto Object failed"),console.log(b)}})},function(a){console.log("error saving photo image "+a)})},a.updateModelObject=function(b){a.loading=!0;for(var c=b.model,d=null,e=0;e<a.columns.length;e++){var f=a.columns[e];if("image"===f.inputType){if("string"!=typeof b[f.key]){var g="photo.jpg";d=new Parse.File(g,b[f.key])}}else c.set(f.key,b[f.key])}var h=function(){c.save({success:function(){var b=a.brand.relation("photos");b.add(c),a.brand.save({success:function(){a.listModelObjects()},error:function(a,b){console.log("create Brand Object failed"),console.log(b)}})},error:function(a,b){console.log("create BrandPhoto Object failed"),console.log(b)}})};d?d.save().then(function(){c.set("image",d),h()},function(a){console.log("error saving photo image "+a)}):h()},a.deleteModelObject=function(b){a.loading=!0;var c=b.model;c.destroy({success:function(){a.listModelObjects()},error:function(a,b){console.log("destroying BrandPhoto Object failed"),console.log(b)}})},a.listModelObjects=function(){var b=a.brand.relation("photos"),c=b.query();c.ascending("orderIndex"),c.find({success:function(b){a.rows=[];for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.createRow(e.get("name"),e.get("image").url(),e.get("displayCopy"),e.get("orderIndex"),e.get("visible"),e))}a.$apply(function(){a.rows=c,a.createColumns()}),a.brand.set("photoCount",c.length),a.brand.save({success:function(){},error:function(a,b){console.log("setting brand photo count failed"),console.log(b)}})},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.getBrandModelObject=function(){var b=Parse.Object.extend("Brand"),c=new Parse.Query(b);c.get(a.brandId,{success:function(b){a.$apply(function(){a.brand=b,a.brandName=b.get("name"),a.title="Brand Photos : "+a.brandName,a.listModelObjects()})},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.getBrandModelObject()}]),angular.module("adminApp").controller("SettingsCtrl",["$scope",function(a){a.title="Settings Photos",a.loading=!0,a.settings={},a.rows=[],a.createRow=function(a,b,c,d,e,f){return{id:f.id,name:a,image:b,displayCopy:c,orderIndex:d,visible:e,model:f,show:!0}},a.searchColumns=["name"],a.createColumns=function(){a.columns=[{label:"Name",key:"name",value:"",inputType:"text",hidden:!1},{label:"Image",key:"image",value:"",inputType:"image",hidden:!1},{label:"Display Copy",key:"displayCopy",value:"",inputType:"text",hidden:!1},{label:"Order Index",key:"orderIndex",value:0,inputType:"number",hidden:!1},{label:"Visible",key:"visible",value:!0,inputType:"checkbox",hidden:!1}],a.loading=!1},a.createModelObject=function(){a.loading=!0;for(var b=Parse.Object.extend("Settings"),c=new b,d={},e=null,f=0;f<a.columns.length;f++){var g=a.columns[f];if("image"===g.inputType){var h="photo.jpg";e=new Parse.File(h,g.value)}else d[g.key]=g.value}e.save().then(function(){c.set("image",e),c.save(d,{success:function(){a.listModelObjects()},error:function(a,b){console.log("create SettingsPhoto Object failed"),console.log(b)}})},function(a){console.log("error saving photo image "+a)})},a.updateModelObject=function(b){a.loading=!0;for(var c=b.model,d=null,e=0;e<a.columns.length;e++){var f=a.columns[e];if("image"===f.inputType){if("string"!=typeof b[f.key]){var g="photo.jpg";d=new Parse.File(g,b[f.key])}}else c.set(f.key,b[f.key])}var h=function(){c.save({success:function(){a.listModelObjects()},error:function(a,b){console.log("create SettingsPhoto Object failed"),console.log(b)}})};d?d.save().then(function(){c.set("image",d),h()},function(a){console.log("error saving photo image "+a)}):h()},a.deleteModelObject=function(b){a.loading=!0;var c=b.model;c.destroy({success:function(){a.listModelObjects()},error:function(a,b){console.log("destroying Settings Photo Object failed"),console.log(b)}})},a.listModelObjects=function(){var b=Parse.Object.extend("Settings"),c=new Parse.Query(b);c.ascending("orderIndex"),c.find({success:function(b){a.rows=[];for(var c=[],d=0;d<b.length;d++){var e=b[d];c.push(a.createRow(e.get("name"),e.get("image").url(),e.get("displayCopy"),e.get("orderIndex"),e.get("visible"),e))}a.$apply(function(){a.rows=c,a.createColumns()})},error:function(a){alert("Error: "+a.code+" "+a.message)}})},a.listModelObjects()}]);